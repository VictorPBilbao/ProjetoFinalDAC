<div class="user-details-wrapper" *ngIf="cliente">
  <div class="header">
    <h2>Perfil do Cliente</h2>
    <div class="status" *ngIf="saved">Alterações salvas!</div>
  </div>

  <div class="account-summary">
    <div class="item">
      <span class="label">Agência</span>
      <span class="value">{{ cliente.agencia }}</span>
    </div>
    <div class="item">
      <span class="label">Conta</span>
      <span class="value">{{ cliente.conta }}</span>
    </div>
    <div class="item">
      <span class="label">Saldo</span>
      <span class="value" [class.negative]="cliente.saldo < 0">
        {{ cliente.saldo | currency : "BRL" : "symbol" : "1.2-2" }}
      </span>
    </div>
    <div class="item">
      <span class="label">Limite</span>
      <span class="value">{{
        cliente.limite | currency : "BRL" : "symbol" : "1.2-2"
      }}</span>
    </div>
    <div class="item">
      <span class="label">Gerente</span>
      <span class="value">{{ cliente.manager.name }}</span>
    </div>
  </div>

  <form [formGroup]="form" (ngSubmit)="salvar()" novalidate>
    <section class="section">
      <h3>Dados Pessoais</h3>
      <div class="grid">
        <div class="form-field">
          <label>Nome</label>
          <input
            type="text"
            formControlName="nome"
            placeholder="Nome"
            [readonly]="!editMode"
          />
          <small *ngIf="form.get('nome')?.invalid && form.get('nome')?.touched"
            >Nome obrigatório (mín. 3)</small
          >
        </div>
        <div class="form-field">
          <label>E-mail</label>
          <input
            type="email"
            formControlName="email"
            placeholder="email@exemplo.com"
            [readonly]="!editMode"
          />
          <small
            *ngIf="form.get('email')?.invalid && form.get('email')?.touched"
            >E-mail inválido</small
          >
        </div>
        <div class="form-field">
          <label>CPF (fixo)</label>
          <input type="text" formControlName="cpf" placeholder="CPF" readonly />
        </div>
        <div class="form-field">
          <label>Telefone</label>
          <input
            type="text"
            formControlName="telefone"
            placeholder="(00) 00000-0000"
            [readonly]="!editMode"
          />
        </div>
        <div class="form-field">
          <label>Salário</label>
          <input
            type="number"
            formControlName="salario"
            step="0.01"
            placeholder="Salário"
            [readonly]="!editMode"
          />
        </div>
      </div>
    </section>

    <section class="section">
      <h3>Endereço</h3>
      <div formGroupName="endereco" class="grid">
        <div class="form-field">
          <label>Tipo</label>
          <input
            type="text"
            formControlName="tipo"
            placeholder="Tipo"
            [readonly]="!editMode"
          />
        </div>
        <div class="form-field">
          <label>Logradouro</label>
          <input
            type="text"
            formControlName="logradouro"
            placeholder="Logradouro"
            [readonly]="!editMode"
          />
        </div>
        <div class="form-field small">
          <label>Número</label>
          <input
            type="text"
            formControlName="numero"
            placeholder="Número"
            [readonly]="!editMode"
          />
        </div>
        <div class="form-field">
          <label>Complemento</label>
          <input
            type="text"
            formControlName="complemento"
            placeholder="Complemento"
            [readonly]="!editMode"
          />
        </div>
        <div class="form-field small">
          <label>CEP</label>
          <input
            type="text"
            formControlName="cep"
            placeholder="00000-000"
            [readonly]="!editMode"
          />
        </div>
        <div class="form-field">
          <label>Cidade</label>
          <input
            type="text"
            formControlName="cidade"
            placeholder="Cidade"
            [readonly]="!editMode"
          />
        </div>
        <div class="form-field tiny">
          <label>Estado</label>
          <input
            type="text"
            maxlength="2"
            formControlName="estado"
            placeholder="UF"
            [readonly]="!editMode"
          />
        </div>
      </div>
    </section>

    <div class="actions">
      <button
        type="button"
        class="btn-outline"
        (click)="toggleEdit()"
        *ngIf="!editMode"
      >
        Editar
      </button>
      <button
        type="button"
        class="btn-text"
        (click)="toggleEdit()"
        *ngIf="editMode"
      >
        Cancelar
      </button>
      <button type="submit" class="btn-primary" *ngIf="editMode">Salvar</button>
    </div>
  </form>

  <div class="preview" *ngIf="saved">
    <h4>Resumo Atualizado</h4>
    <pre>{{ cliente | json }}</pre>
  </div>
</div>
